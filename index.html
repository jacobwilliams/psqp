

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="description" content="Modern Fortran edition of PSQP">
    <meta name="author" content="Jacob Williams" >
    <link rel="icon" href="./favicon.png">

    <title> psqp </title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <!-- Font Awesome -->
    <link href="./css/fontawesome.min.css" rel="stylesheet">
    <link href="./css/brands.min.css" rel="stylesheet">
    <link href="./css/regular.min.css" rel="stylesheet">
    <link href="./css/solid.min.css" rel="stylesheet">
    <link href="./css/v4-font-face.min.css" rel="stylesheet">
    <link href="./css/v4-shims.min.css" rel="stylesheet">
    <!-- MathJax -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { equationNumbers: { autoNumber: "AMS" } }
      });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async
            integrity="sha256-DViIOMYdwlM/axqoGDPeUyf0urLoHMN4QACBKyB58Uw=" crossorigin="anonymous"></script>
    <!-- Other scripts and stylesheets -->
    <link href="./css/local.css" rel="stylesheet">
    <link href="./css/pygments.css" rel="stylesheet">
    <script src="./js/svg-pan-zoom.min.js"></script>
  </head>

  <body>

    <!-- Fixed navbar -->
    <div class="container-fluid mb-sm-4 mb-xl-2">
      <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
        <div class="container">
          <a class="navbar-brand" href="./index.html">psqp </a>
          <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar"
                  aria-expanded="false" aria-controls="navbar" aria-label="Toggle navigation">
                  <span class="navbar-toggler-icon">
          </button>

          <div id="navbar" class="navbar-collapse collapse">
            <ul class="navbar-nav">
                  <li class="nav-item">
                    <a class="nav-link" href="./lists/files.html">Source Files</a>
                  </li>
                <li class="nav-item">
                  <a class="nav-link" href="./lists/modules.html">Modules</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="./lists/procedures.html">Procedures</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="./lists/absint.html">Abstract Interfaces</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="./lists/types.html">Derived Types</a>
                </li>
            </ul>
              <div class="d-flex align-items-end flex-grow-1">
                <form action="./search.html" role="search" class="ms-auto">
                  <input type="text" class="form-control" aria-label="Search" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
                </form>
              </div>
          </div><!--/.nav-collapse -->
        </div>
      </nav>
    </div>

    <div class="container">
  <!-- Main component for a primary marketing message or call to action -->
    <div class="p-5 mb-4 bg-light border rounded-3" id="jumbotron">
      <p>Modern Fortran edition of PSQP</p>
        <p> Find us on&hellip;</p>
      <p>
        <a class="btn btn-lg btn-primary" href="https://github.com/jacobwilliams/psqp" role="button">GitHub</a>
        
        
        
        
      </p>
    </div>

      <div class="row" id='text'>
        <div class=col-md-8>
          <h1>psqp</h1>
          <p>PSQP - A sequential quadratic programming algorithm
for general nonlinear programming problems.</p>
<p><a href="https://github.com/topics/fortran"><img alt="Language" src="https://img.shields.io/badge/-Fortran-734f96?logo=fortran&amp;logoColor=white"></a>
<a href="https://github.com/jacobwilliams/psqp/actions"><img alt="CI Status" src="https://github.com/jacobwilliams/psqp/actions/workflows/CI.yml/badge.svg"></a>
<a href="https://github.com/jacobwilliams/psqp/commits/master"><img alt="last-commit" src="https://img.shields.io/github/last-commit/jacobwilliams/psqp"></a></p>
<p>This is work in progress to refactor the original <a href="http://www.cs.cas.cz/~luksan/subroutines.html">PSQP</a> (by Ladislav Luksan) into Modern Fortran. The latest API documentation can be found <a href="https://jacobwilliams.github.io/psqp/index.html">here</a>.</p>
<h1>Original Readme</h1>
<h2>Introduction</h2>
<p>The double-precision FORTRAN 77 basic subroutine PSQP is designed
to find a close approximation to a local minimum of a nonlinear
objective function F(X) with simple bounds on variables and general
nonlinear constraints. Here X is a vector of N variables and F(X), is
a smooth function. Simple bounds are assumed in the form</p>
<div class="codehilite"><pre><span></span><code><span class="w">               </span><span class="nv">X</span><span class="ss">(</span><span class="nv">I</span><span class="ss">)</span><span class="w"> </span><span class="nv">unbounded</span><span class="w"> </span><span class="k">if</span><span class="w">  </span><span class="nv">IX</span><span class="ss">(</span><span class="nv">I</span><span class="ss">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>,
<span class="w">      </span><span class="nv">XL</span><span class="ss">(</span><span class="nv">I</span><span class="ss">)</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="nv">X</span><span class="ss">(</span><span class="nv">I</span><span class="ss">)</span><span class="w">           </span><span class="k">if</span><span class="w">  </span><span class="nv">IX</span><span class="ss">(</span><span class="nv">I</span><span class="ss">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>,
<span class="w">               </span><span class="nv">X</span><span class="ss">(</span><span class="nv">I</span><span class="ss">)</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="nv">XU</span><span class="ss">(</span><span class="nv">I</span><span class="ss">)</span><span class="w">  </span><span class="k">if</span><span class="w">  </span><span class="nv">IX</span><span class="ss">(</span><span class="nv">I</span><span class="ss">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span>,
<span class="w">      </span><span class="nv">XL</span><span class="ss">(</span><span class="nv">I</span><span class="ss">)</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="nv">X</span><span class="ss">(</span><span class="nv">I</span><span class="ss">)</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="nv">XU</span><span class="ss">(</span><span class="nv">I</span><span class="ss">)</span><span class="w">  </span><span class="k">if</span><span class="w">  </span><span class="nv">IX</span><span class="ss">(</span><span class="nv">I</span><span class="ss">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span>,
<span class="w">      </span><span class="nv">XL</span><span class="ss">(</span><span class="nv">I</span><span class="ss">)</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="nv">X</span><span class="ss">(</span><span class="nv">I</span><span class="ss">)</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="nv">XU</span><span class="ss">(</span><span class="nv">I</span><span class="ss">)</span><span class="w">  </span><span class="k">if</span><span class="w">  </span><span class="nv">IX</span><span class="ss">(</span><span class="nv">I</span><span class="ss">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span>,
</code></pre></div>

<p>where 1 &lt;= I &lt;= N. General nonlinear constraints are assumed in the form</p>
<div class="codehilite"><pre><span></span><code>               C_I(X) unbounded if  IC(I) = 0,
      CL(I) &lt;= C_I(X)           if  IC(I) = 1,
               C_I(X) &lt;= CU(I)  if  IC(I) = 2,
      CL(I) &lt;= C_I(X) &lt;= CU(I)  if  IC(I) = 3,
      CL(I)  = C_I(X)  = CU(I)  if  IC(I) = 5,
</code></pre></div>

<p>where C_I(X), 1 &lt;= I &lt;= NC, are twice continuously differentiable
functions.</p>
<p>To simplify user's work, an additional easy to use subroutine
PSQPN is added. It calls the basic general subroutine PSQP. All
subroutines contain a description of formal parameters and extensive
comments. Furthermore, test program TSQPN is included, which contains
several test problems. This test programs serve as an example for
using the subroutine PSQPN, verify its correctness and demonstrate
its efficiency.</p>
<p>In this short guide, we describe all subroutines which can be
called from the user's program. In the description of formal parameters,
we introduce a type of the argument that specifies whether the argument
must have a value defined on entry to the subroutine (I), whether it
is a value which will be returned (O), or both (U), or whether it is
an auxiliary value (A). Note that the arguments of the type I can be
changed on output under some circumstances, especially if improper
input values were given. Besides formal parameters, we can use a
COMMON /STAT/ block containing statistical information. This block,
used in each subroutine has the following form:</p>
<div class="codehilite"><pre><span></span><code>      COMMON /STAT/ NRES,NDEC,NREM,NADD,NIT,NFV,NFG,NFH
</code></pre></div>

<p>The arguments have the following meaning:</p>
<div class="codehilite"><pre><span></span><code><span class="w"> </span><span class="n">Argument</span><span class="w">  </span><span class="n">Type</span><span class="w"> </span><span class="n">Significance</span>
<span class="w"> </span><span class="o">----------------------------------------------------------------------</span>
<span class="w">  </span><span class="n">NRES</span><span class="w">      </span><span class="n">O</span><span class="w">   </span><span class="n">Positive</span><span class="w"> </span><span class="n">INTEGER</span><span class="w"> </span><span class="n">variable</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">indicates</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">of</span>
<span class="w">                </span><span class="n">restarts</span><span class="o">.</span>
<span class="w">  </span><span class="n">NDEC</span><span class="w">      </span><span class="n">O</span><span class="w">   </span><span class="n">Positive</span><span class="w"> </span><span class="n">INTEGER</span><span class="w"> </span><span class="n">variable</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">indicates</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">of</span>
<span class="w">                </span><span class="n">matrix</span><span class="w"> </span><span class="n">decompositions</span><span class="o">.</span>
<span class="w">  </span><span class="n">NRED</span><span class="w">      </span><span class="n">O</span><span class="w">   </span><span class="n">Positive</span><span class="w"> </span><span class="n">INTEGER</span><span class="w"> </span><span class="n">variable</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">indicates</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">of</span>
<span class="w">                </span><span class="n">reductions</span><span class="o">.</span>
<span class="w">  </span><span class="n">NREM</span><span class="w">      </span><span class="n">O</span><span class="w">   </span><span class="n">Positive</span><span class="w"> </span><span class="n">INTEGER</span><span class="w"> </span><span class="n">variable</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">indicates</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">of</span>
<span class="w">                </span><span class="n">constraint</span><span class="w"> </span><span class="n">deletions</span><span class="w"> </span><span class="n">during</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">QP</span><span class="w"> </span><span class="n">solutions</span><span class="o">.</span>
<span class="w">  </span><span class="n">NADD</span><span class="w">      </span><span class="n">O</span><span class="w">   </span><span class="n">Positive</span><span class="w"> </span><span class="n">INTEGER</span><span class="w"> </span><span class="n">variable</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">indicates</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">of</span>
<span class="w">                </span><span class="n">constraint</span><span class="w"> </span><span class="n">additions</span><span class="w"> </span><span class="n">during</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">QP</span><span class="w"> </span><span class="n">solutions</span><span class="o">.</span>
<span class="w">  </span><span class="n">NIT</span><span class="w">       </span><span class="n">O</span><span class="w">   </span><span class="n">Positive</span><span class="w"> </span><span class="n">INTEGER</span><span class="w"> </span><span class="n">variable</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">indicates</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">of</span>
<span class="w">                </span><span class="n">iterations</span><span class="o">.</span>
<span class="w">  </span><span class="n">NFV</span><span class="w">       </span><span class="n">O</span><span class="w">   </span><span class="n">Positive</span><span class="w"> </span><span class="n">INTEGER</span><span class="w"> </span><span class="n">variable</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">indicates</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">of</span>
<span class="w">                </span><span class="n">function</span><span class="w"> </span><span class="n">evaluations</span><span class="o">.</span>
<span class="w">  </span><span class="n">NFG</span><span class="w">       </span><span class="n">O</span><span class="w">   </span><span class="n">Positive</span><span class="w"> </span><span class="n">INTEGER</span><span class="w"> </span><span class="n">variable</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">specifies</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">of</span>
<span class="w">                </span><span class="n">gradient</span><span class="w"> </span><span class="n">evaluations</span><span class="o">.</span>
<span class="w">  </span><span class="n">NFH</span><span class="w">       </span><span class="n">O</span><span class="w">   </span><span class="n">Positive</span><span class="w"> </span><span class="n">INTEGER</span><span class="w"> </span><span class="n">variable</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">specifies</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">of</span>
<span class="w">                </span><span class="n">Hessian</span><span class="w"> </span><span class="n">evaluations</span><span class="o">.</span>
</code></pre></div>

<h2>Subroutine PSQN</h2>
<p>The calling sequence is</p>
<div class="codehilite"><pre><span></span><code>      CALL PSQPN(NF,NB,NC,X,IX,XL,XU,CF,IC,CL,CU,IPAR,RPAR,F,GMAX,
     &amp;           CMAX,IPRNT,ITERM)
</code></pre></div>

<p>The arguments have the following meaning.</p>
<div class="codehilite"><pre><span></span><code><span class="w"> </span><span class="nx">Argument</span><span class="w">  </span><span class="nx">Type</span><span class="w"> </span><span class="nx">Significance</span>
<span class="w"> </span><span class="o">----------------------------------------------------------------------</span>
<span class="w">  </span><span class="nx">NF</span><span class="w">        </span><span class="nx">I</span><span class="w">   </span><span class="nx">Positive</span><span class="w"> </span><span class="nx">INTEGER</span><span class="w"> </span><span class="nx">variable</span><span class="w"> </span><span class="nx">that</span><span class="w"> </span><span class="nx">specifies</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">number</span><span class="w"> </span><span class="nx">of</span>
<span class="w">                </span><span class="nx">variables</span><span class="w"> </span><span class="nx">of</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">objective</span><span class="w"> </span><span class="nx">function</span><span class="p">.</span>
<span class="w">  </span><span class="nx">NB</span><span class="w">        </span><span class="nx">I</span><span class="w">   </span><span class="nx">Nonnegative</span><span class="w"> </span><span class="nx">INTEGER</span><span class="w"> </span><span class="nx">variable</span><span class="w"> </span><span class="nx">that</span><span class="w"> </span><span class="nx">specifies</span><span class="w"> </span><span class="nx">whether</span><span class="w"> </span><span class="nx">the</span>
<span class="w">                </span><span class="nx">simple</span><span class="w"> </span><span class="nx">bounds</span><span class="w"> </span><span class="nx">are</span><span class="w"> </span><span class="nx">suppressed</span><span class="w"> </span><span class="p">(</span><span class="nx">NB</span><span class="p">=</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="nx">accepted</span><span class="w"> </span><span class="p">(</span><span class="nx">NB</span><span class="p">&gt;</span><span class="mi">0</span><span class="p">).</span>
<span class="w">  </span><span class="nx">NC</span><span class="w">        </span><span class="nx">I</span><span class="w">   </span><span class="nx">Nonnegative</span><span class="w"> </span><span class="nx">INTEGER</span><span class="w"> </span><span class="nx">variable</span><span class="w"> </span><span class="nx">that</span><span class="w"> </span><span class="nx">specifies</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">number</span>
<span class="w">                </span><span class="nx">of</span><span class="w"> </span><span class="nx">general</span><span class="w"> </span><span class="nx">nonlinear</span><span class="w"> </span><span class="nx">constraints</span><span class="p">;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="nx">NC</span><span class="p">=</span><span class="mi">0</span><span class="w"> </span><span class="nx">the</span>
<span class="w">                </span><span class="nx">general</span><span class="w"> </span><span class="nx">nonlinear</span><span class="w"> </span><span class="nx">constraints</span><span class="w"> </span><span class="nx">are</span><span class="w"> </span><span class="nx">suppressed</span><span class="p">.</span>
<span class="w">  </span><span class="nx">X</span><span class="p">(</span><span class="nx">NF</span><span class="p">)</span><span class="w">     </span><span class="nx">U</span><span class="w">   </span><span class="nx">On</span><span class="w"> </span><span class="nx">input</span><span class="p">,</span><span class="w"> </span><span class="nx">DOUBLE</span><span class="w"> </span><span class="nx">PRECISION</span><span class="w"> </span><span class="nx">vector</span><span class="w"> </span><span class="nx">with</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">initial</span>
<span class="w">                </span><span class="nx">estimate</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">solution</span><span class="p">.</span><span class="w"> </span><span class="nx">On</span><span class="w"> </span><span class="nx">output</span><span class="p">,</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">approximation</span>
<span class="w">                </span><span class="nx">to</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">minimum</span><span class="p">.</span>
<span class="w">  </span><span class="nx">IX</span><span class="p">(</span><span class="nx">NF</span><span class="p">)</span><span class="w">    </span><span class="nx">I</span><span class="w">   </span><span class="nx">On</span><span class="w"> </span><span class="nx">input</span><span class="w"> </span><span class="p">(</span><span class="nx">significant</span><span class="w"> </span><span class="nx">only</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="nx">NB</span><span class="p">&gt;</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="nx">INTEGER</span><span class="w"> </span><span class="nx">vector</span>
<span class="w">                </span><span class="nx">containing</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">simple</span><span class="w"> </span><span class="nx">bounds</span><span class="w"> </span><span class="nx">types</span><span class="p">:</span>
<span class="w">                   </span><span class="nx">IX</span><span class="p">(</span><span class="nx">I</span><span class="p">)=</span><span class="mi">0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">variable</span><span class="w"> </span><span class="nx">X</span><span class="p">(</span><span class="nx">I</span><span class="p">)</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="nx">unbounded</span><span class="p">,</span>
<span class="w">                   </span><span class="nx">IX</span><span class="p">(</span><span class="nx">I</span><span class="p">)=</span><span class="mi">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">lower</span><span class="w"> </span><span class="nx">bound</span><span class="w"> </span><span class="nx">X</span><span class="p">(</span><span class="nx">I</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="nx">XL</span><span class="p">(</span><span class="nx">I</span><span class="p">),</span>
<span class="w">                   </span><span class="nx">IX</span><span class="p">(</span><span class="nx">I</span><span class="p">)=</span><span class="mi">2</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">upper</span><span class="w"> </span><span class="nx">bound</span><span class="w"> </span><span class="nx">X</span><span class="p">(</span><span class="nx">I</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="nx">XU</span><span class="p">(</span><span class="nx">I</span><span class="p">),</span>
<span class="w">                   </span><span class="nx">IX</span><span class="p">(</span><span class="nx">I</span><span class="p">)=</span><span class="mi">3</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">two</span><span class="w"> </span><span class="nx">side</span><span class="w"> </span><span class="nx">bound</span><span class="w"> </span><span class="nx">XL</span><span class="p">(</span><span class="nx">I</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="nx">X</span><span class="p">(</span><span class="nx">I</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="nx">XU</span><span class="p">(</span><span class="nx">I</span><span class="p">),</span>
<span class="w">                   </span><span class="nx">IX</span><span class="p">(</span><span class="nx">I</span><span class="p">)=</span><span class="mi">5</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">variable</span><span class="w"> </span><span class="nx">X</span><span class="p">(</span><span class="nx">I</span><span class="p">)</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="nx">fixed</span><span class="w"> </span><span class="p">(</span><span class="nx">given</span><span class="w"> </span><span class="nx">by</span><span class="w"> </span><span class="nx">its</span>
<span class="w">                             </span><span class="nx">initial</span><span class="w"> </span><span class="nx">estimate</span><span class="p">).</span>
<span class="w">  </span><span class="nx">XL</span><span class="p">(</span><span class="nx">NF</span><span class="p">)</span><span class="w">    </span><span class="nx">I</span><span class="w">   </span><span class="nx">DOUBLE</span><span class="w"> </span><span class="nx">PRECISION</span><span class="w"> </span><span class="nx">vector</span><span class="w"> </span><span class="nx">with</span><span class="w"> </span><span class="nx">lower</span><span class="w"> </span><span class="nx">bounds</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nx">variables</span>
<span class="w">                </span><span class="p">(</span><span class="nx">significant</span><span class="w"> </span><span class="nx">only</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="nx">NB</span><span class="p">&gt;</span><span class="mi">0</span><span class="p">).</span>
<span class="w">  </span><span class="nx">XU</span><span class="p">(</span><span class="nx">NF</span><span class="p">)</span><span class="w">    </span><span class="nx">I</span><span class="w">   </span><span class="nx">DOUBLE</span><span class="w"> </span><span class="nx">PRECISION</span><span class="w"> </span><span class="nx">vector</span><span class="w"> </span><span class="nx">with</span><span class="w"> </span><span class="nx">upper</span><span class="w"> </span><span class="nx">bounds</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nx">variables</span>
<span class="w">                </span><span class="p">(</span><span class="nx">significant</span><span class="w"> </span><span class="nx">only</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="nx">NB</span><span class="p">&gt;</span><span class="mi">0</span><span class="p">).</span>
<span class="w">  </span><span class="nx">CF</span><span class="p">(</span><span class="nx">NC</span><span class="p">)</span><span class="w">    </span><span class="nx">A</span><span class="w">   </span><span class="nx">DOUBLE</span><span class="w"> </span><span class="nx">PRECISION</span><span class="w"> </span><span class="nx">vector</span><span class="w"> </span><span class="nx">which</span><span class="w"> </span><span class="nx">contains</span><span class="w"> </span><span class="nx">values</span><span class="w"> </span><span class="nx">of</span>
<span class="w">                </span><span class="kd">constraint</span><span class="w"> </span><span class="nx">functions</span><span class="w"> </span><span class="p">(</span><span class="nx">only</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="nx">NC</span><span class="p">&gt;</span><span class="mi">0</span><span class="p">).</span>
<span class="w">  </span><span class="nx">IC</span><span class="p">(</span><span class="nx">NC</span><span class="p">)</span><span class="w">    </span><span class="nx">I</span><span class="w">   </span><span class="nx">On</span><span class="w"> </span><span class="nx">input</span><span class="w"> </span><span class="p">(</span><span class="nx">significant</span><span class="w"> </span><span class="nx">only</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="nx">NC</span><span class="p">&gt;</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="nx">INTEGER</span><span class="w"> </span><span class="nx">vector</span><span class="w"> </span><span class="nx">which</span>
<span class="w">                </span><span class="nx">contains</span><span class="w"> </span><span class="kd">constraint</span><span class="w"> </span><span class="nx">types</span><span class="p">:</span>
<span class="w">                  </span><span class="nx">IC</span><span class="p">(</span><span class="nx">K</span><span class="p">)=</span><span class="mi">0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="kd">constraint</span><span class="w"> </span><span class="nx">CF</span><span class="p">(</span><span class="nx">K</span><span class="p">)</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="nx">used</span><span class="p">,</span>
<span class="w">                  </span><span class="nx">IC</span><span class="p">(</span><span class="nx">K</span><span class="p">)=</span><span class="mi">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">lower</span><span class="w"> </span><span class="kd">constraint</span><span class="w"> </span><span class="nx">CF</span><span class="p">(</span><span class="nx">K</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="nx">CL</span><span class="p">(</span><span class="nx">K</span><span class="p">),</span>
<span class="w">                  </span><span class="nx">IC</span><span class="p">(</span><span class="nx">K</span><span class="p">)=</span><span class="mi">2</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">upper</span><span class="w"> </span><span class="kd">constraint</span><span class="w"> </span><span class="nx">CF</span><span class="p">(</span><span class="nx">K</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="nx">CU</span><span class="p">(</span><span class="nx">K</span><span class="p">),</span>
<span class="w">                  </span><span class="nx">IC</span><span class="p">(</span><span class="nx">K</span><span class="p">)=</span><span class="mi">3</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">two</span><span class="w"> </span><span class="nx">side</span><span class="w"> </span><span class="kd">constraint</span>
<span class="w">                            </span><span class="nx">CL</span><span class="p">(</span><span class="nx">K</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="nx">CF</span><span class="p">(</span><span class="nx">K</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="nx">CU</span><span class="p">(</span><span class="nx">K</span><span class="p">),</span>
<span class="w">                  </span><span class="nx">IC</span><span class="p">(</span><span class="nx">K</span><span class="p">)=</span><span class="mi">5</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">equality</span><span class="w"> </span><span class="kd">constraint</span><span class="w"> </span><span class="nx">CF</span><span class="p">(</span><span class="nx">K</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">CL</span><span class="p">(</span><span class="nx">K</span><span class="p">).</span>
<span class="w">  </span><span class="nx">CL</span><span class="p">(</span><span class="nx">NC</span><span class="p">)</span><span class="w">    </span><span class="nx">I</span><span class="w">   </span><span class="nx">DOUBLE</span><span class="w"> </span><span class="nx">PRECISION</span><span class="w"> </span><span class="nx">vector</span><span class="w"> </span><span class="nx">with</span><span class="w"> </span><span class="nx">lower</span><span class="w"> </span><span class="nx">bounds</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="kd">constraint</span>
<span class="w">                </span><span class="nx">functions</span><span class="w"> </span><span class="p">(</span><span class="nx">significant</span><span class="w"> </span><span class="nx">only</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="nx">NC</span><span class="p">&gt;</span><span class="mi">0</span><span class="p">).</span>
<span class="w">  </span><span class="nx">CU</span><span class="p">(</span><span class="nx">NC</span><span class="p">)</span><span class="w">    </span><span class="nx">I</span><span class="w">   </span><span class="nx">DOUBLE</span><span class="w"> </span><span class="nx">PRECISION</span><span class="w"> </span><span class="nx">vector</span><span class="w"> </span><span class="nx">with</span><span class="w"> </span><span class="nx">upper</span><span class="w"> </span><span class="nx">bounds</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="kd">constraint</span>
<span class="w">                </span><span class="nx">functions</span><span class="w"> </span><span class="p">(</span><span class="nx">significant</span><span class="w"> </span><span class="nx">only</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="nx">NC</span><span class="p">&gt;</span><span class="mi">0</span><span class="p">).</span>
<span class="w">  </span><span class="nx">IPAR</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="w">   </span><span class="nx">A</span><span class="w">   </span><span class="nx">INTEGER</span><span class="w"> </span><span class="nx">parameters</span><span class="p">:</span>
<span class="w">                  </span><span class="nx">IPAR</span><span class="p">(</span><span class="mi">1</span><span class="p">)=</span><span class="nx">MIT</span><span class="p">,</span><span class="w">  </span><span class="nx">IPAR</span><span class="p">(</span><span class="mi">2</span><span class="p">)=</span><span class="nx">MFV</span><span class="p">,</span><span class="w"> </span><span class="nx">IPAR</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">-</span><span class="nx">NONE</span><span class="p">,</span>
<span class="w">                  </span><span class="nx">IPAR</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">-</span><span class="nx">NONE</span><span class="p">,</span><span class="w"> </span><span class="nx">IPAR</span><span class="p">(</span><span class="mi">5</span><span class="p">)=</span><span class="nx">MET</span><span class="p">,</span><span class="w"> </span><span class="nx">IPAR</span><span class="p">(</span><span class="mi">5</span><span class="p">)=</span><span class="nx">MEC</span><span class="p">.</span>
<span class="w">                </span><span class="nx">Parameters</span><span class="w"> </span><span class="nx">MIT</span><span class="p">,</span><span class="w"> </span><span class="nx">MFV</span><span class="p">,</span><span class="w"> </span><span class="nx">MET</span><span class="p">,</span><span class="w"> </span><span class="nx">MEC</span><span class="w"> </span><span class="nx">are</span><span class="w"> </span><span class="nx">described</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="nx">Section</span><span class="w"> </span><span class="mi">3</span>
<span class="w">                </span><span class="nx">together</span><span class="w"> </span><span class="nx">with</span><span class="w"> </span><span class="nx">other</span><span class="w"> </span><span class="nx">parameters</span><span class="w"> </span><span class="nx">of</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">subroutine</span><span class="w"> </span><span class="nx">PSQP</span><span class="p">.</span>
<span class="w">  </span><span class="nx">RPAR</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="w">   </span><span class="nx">A</span><span class="w">   </span><span class="nx">DOUBLE</span><span class="w"> </span><span class="nx">PRECISION</span><span class="w"> </span><span class="nx">parameters</span><span class="p">:</span>
<span class="w">                  </span><span class="nx">RPAR</span><span class="p">(</span><span class="mi">1</span><span class="p">)=</span><span class="nx">XMAX</span><span class="p">,</span><span class="w">  </span><span class="nx">RPAR</span><span class="p">(</span><span class="mi">2</span><span class="p">)=</span><span class="nx">TOLX</span><span class="p">,</span><span class="w">  </span><span class="nx">RPAR</span><span class="p">(</span><span class="mi">3</span><span class="p">)=</span><span class="nx">TOLC</span><span class="p">,</span>
<span class="w">                  </span><span class="nx">RPAR</span><span class="p">(</span><span class="mi">4</span><span class="p">)=</span><span class="nx">TOLG</span><span class="p">,</span><span class="w">  </span><span class="nx">RPAR</span><span class="p">(</span><span class="mi">5</span><span class="p">)=</span><span class="nx">RPF</span><span class="p">.</span>
<span class="w">                </span><span class="nx">Parameters</span><span class="w"> </span><span class="nx">XMAX</span><span class="p">,</span><span class="w"> </span><span class="nx">TOLX</span><span class="p">,</span><span class="w"> </span><span class="nx">TOLC</span><span class="p">,</span><span class="w"> </span><span class="nx">TOLG</span><span class="p">,</span><span class="w"> </span><span class="nx">RPF</span><span class="w"> </span><span class="nx">are</span><span class="w"> </span><span class="nx">described</span>
<span class="w">                </span><span class="k">in</span><span class="w"> </span><span class="nx">Section</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="nx">together</span><span class="w"> </span><span class="nx">with</span><span class="w"> </span><span class="nx">other</span><span class="w"> </span><span class="nx">parameters</span><span class="w"> </span><span class="nx">of</span><span class="w"> </span><span class="nx">the</span>
<span class="w">                </span><span class="nx">subroutine</span><span class="w"> </span><span class="nx">PSQP</span><span class="p">.</span>
<span class="w">  </span><span class="nx">F</span><span class="w">         </span><span class="nx">O</span><span class="w">   </span><span class="nx">DOUBLE</span><span class="w"> </span><span class="nx">PRECISION</span><span class="w"> </span><span class="nx">value</span><span class="w"> </span><span class="nx">of</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">objective</span><span class="w"> </span><span class="nx">function</span><span class="w"> </span><span class="nx">at</span><span class="w"> </span><span class="nx">the</span>
<span class="w">                </span><span class="nx">solution</span><span class="w"> </span><span class="nx">X</span><span class="p">.</span>
<span class="w">  </span><span class="nx">GMAX</span><span class="w">      </span><span class="nx">O</span><span class="w">   </span><span class="nx">DOUBLE</span><span class="w"> </span><span class="nx">PRECISION</span><span class="w"> </span><span class="nx">maximum</span><span class="w"> </span><span class="nx">absolute</span><span class="w"> </span><span class="nx">value</span><span class="w"> </span><span class="nx">of</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="k">partial</span>
<span class="w">                </span><span class="nx">derivative</span><span class="w"> </span><span class="nx">of</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">Lagrangian</span><span class="w"> </span><span class="nx">function</span><span class="p">.</span>
<span class="w">  </span><span class="nx">CMAX</span><span class="w">      </span><span class="nx">O</span><span class="w">   </span><span class="nx">maximum</span><span class="w"> </span><span class="kd">constraint</span><span class="w"> </span><span class="nx">violation</span><span class="p">.</span>
<span class="w">  </span><span class="nx">IPRNT</span><span class="w">     </span><span class="nx">I</span><span class="w">   </span><span class="nx">INTEGER</span><span class="w"> </span><span class="nx">variable</span><span class="w"> </span><span class="nx">that</span><span class="w"> </span><span class="nx">specifies</span><span class="w"> </span><span class="nx">PRINT</span><span class="p">:</span>
<span class="w">                  </span><span class="nx">IPRNT</span><span class="p">=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">print</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="nx">suppressed</span><span class="p">,</span>
<span class="w">                  </span><span class="nx">IPRNT</span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">basic</span><span class="w"> </span><span class="nx">print</span><span class="w"> </span><span class="nx">of</span><span class="w"> </span><span class="k">final</span><span class="w"> </span><span class="nx">results</span><span class="p">,</span>
<span class="w">                  </span><span class="nx">IPRNT</span><span class="p">=</span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">extended</span><span class="w"> </span><span class="nx">print</span><span class="w"> </span><span class="nx">of</span><span class="w"> </span><span class="k">final</span><span class="w"> </span><span class="nx">results</span><span class="p">,</span>
<span class="w">                  </span><span class="nx">IPRNT</span><span class="p">=</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">basic</span><span class="w"> </span><span class="nx">print</span><span class="w"> </span><span class="nx">of</span><span class="w"> </span><span class="nx">intermediate</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="k">final</span>
<span class="w">                             </span><span class="nx">results</span><span class="p">,</span>
<span class="w">                  </span><span class="nx">IPRNT</span><span class="p">=</span><span class="o">-</span><span class="mi">2</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">extended</span><span class="w"> </span><span class="nx">print</span><span class="w"> </span><span class="nx">of</span><span class="w"> </span><span class="nx">intermediate</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="k">final</span>
<span class="w">                             </span><span class="nx">results</span><span class="p">.</span>
<span class="w">  </span><span class="nx">ITERM</span><span class="w">     </span><span class="nx">O</span><span class="w">   </span><span class="nx">INTEGER</span><span class="w"> </span><span class="nx">variable</span><span class="w"> </span><span class="nx">that</span><span class="w"> </span><span class="nx">indicates</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">cause</span><span class="w"> </span><span class="nx">of</span><span class="w"> </span><span class="nx">termination</span><span class="p">:</span>
<span class="w">                  </span><span class="nx">ITERM</span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="o">|</span><span class="nx">X</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">XO</span><span class="o">|</span><span class="w"> </span><span class="nx">was</span><span class="w"> </span><span class="nx">less</span><span class="w"> </span><span class="nx">than</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="nx">equal</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">TOLX</span>
<span class="w">                             </span><span class="k">in</span><span class="w"> </span><span class="nx">MTESX</span><span class="w"> </span><span class="nx">subsequent</span><span class="w"> </span><span class="nx">iterations</span><span class="p">,</span>
<span class="w">                  </span><span class="nx">ITERM</span><span class="p">=</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="o">|</span><span class="nx">F</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">FO</span><span class="o">|</span><span class="w"> </span><span class="nx">was</span><span class="w"> </span><span class="nx">less</span><span class="w"> </span><span class="nx">than</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="nx">equal</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">TOLF</span>
<span class="w">                             </span><span class="k">in</span><span class="w"> </span><span class="nx">MTESF</span><span class="w"> </span><span class="nx">subsequent</span><span class="w"> </span><span class="nx">iterations</span><span class="p">,</span>
<span class="w">                  </span><span class="nx">ITERM</span><span class="p">=</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="nx">F</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="nx">less</span><span class="w"> </span><span class="nx">than</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="nx">equal</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">TOLB</span><span class="p">,</span>
<span class="w">                  </span><span class="nx">ITERM</span><span class="p">=</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="nx">GMAX</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="nx">less</span><span class="w"> </span><span class="nx">than</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="nx">equal</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">TOLG</span><span class="p">,</span>
<span class="w">                  </span><span class="nx">ITERM</span><span class="p">=</span><span class="mi">11</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="nx">NIT</span><span class="w"> </span><span class="nx">exceeded</span><span class="w"> </span><span class="nx">MIT</span><span class="p">,</span>
<span class="w">                  </span><span class="nx">ITERM</span><span class="p">=</span><span class="mi">12</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="nx">NFV</span><span class="w"> </span><span class="nx">exceeded</span><span class="w"> </span><span class="nx">MFV</span><span class="p">,</span>
<span class="w">                  </span><span class="nx">ITERM</span><span class="p">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">method</span><span class="w"> </span><span class="nx">failed</span><span class="p">.</span><span class="w"> </span><span class="nx">If</span><span class="w"> </span><span class="nx">ITERM</span><span class="p">=</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="nx">the</span>
<span class="w">                             </span><span class="nx">termination</span><span class="w"> </span><span class="nx">criterion</span><span class="w"> </span><span class="nx">has</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="nx">been</span><span class="w"> </span><span class="nx">satisfied</span><span class="p">,</span>
<span class="w">                             </span><span class="nx">but</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">point</span><span class="w"> </span><span class="nx">obtained</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="nx">usually</span><span class="w"> </span><span class="nx">acceptable</span><span class="p">.</span>
</code></pre></div>

<p>The subroutine PSQPN requires the user supplied subroutines OBJ,
DOBJ that define the objective function and its gradient and CON, DCON
that define constraint functions and their gradients. These subroutines
have the form</p>
<div class="codehilite"><pre><span></span><code>      SUBROUTINE  OBJ(NF,X,F)
      SUBROUTINE DOBJ(NF,X,G)
      SUBROUTINE  CON(NF,KC,X,FC)
      SUBROUTINE DCON(NF,KC,X,GC)
</code></pre></div>

<p>The arguments of the user supplied subroutine have the following meaning.</p>
<div class="codehilite"><pre><span></span><code><span class="w"> </span><span class="n">Argument</span><span class="w">  </span><span class="n">Type</span><span class="w"> </span><span class="n">Significance</span>
<span class="w"> </span><span class="o">----------------------------------------------------------------------</span>
<span class="w">  </span><span class="n">NF</span><span class="w">        </span><span class="n">I</span><span class="w">   </span><span class="n">Positive</span><span class="w"> </span><span class="n">INTEGER</span><span class="w"> </span><span class="n">variable</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">specifies</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">of</span>
<span class="w">                </span><span class="n">variables</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">objective</span><span class="w"> </span><span class="n">function</span><span class="o">.</span>
<span class="w">  </span><span class="n">X</span><span class="p">(</span><span class="n">NF</span><span class="p">)</span><span class="w">     </span><span class="n">I</span><span class="w">   </span><span class="n">DOUBLE</span><span class="w"> </span><span class="n">PRECISION</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">estimate</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">solution</span><span class="o">.</span>
<span class="w">  </span><span class="n">F</span><span class="w">         </span><span class="n">O</span><span class="w">   </span><span class="n">DOUBLE</span><span class="w"> </span><span class="n">PRECISION</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">objective</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">the</span>
<span class="w">                </span><span class="n">point</span><span class="w"> </span><span class="n">X</span><span class="o">.</span>
<span class="w">  </span><span class="n">G</span><span class="p">(</span><span class="n">NF</span><span class="p">)</span><span class="w">     </span><span class="n">O</span><span class="w">   </span><span class="n">DOUBLE</span><span class="w"> </span><span class="n">PRECISION</span><span class="w"> </span><span class="n">gradient</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">objective</span><span class="w"> </span><span class="n">function</span>
<span class="w">                </span><span class="n">at</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">point</span><span class="w"> </span><span class="n">X</span><span class="o">.</span>
<span class="w">  </span><span class="n">KC</span><span class="w">        </span><span class="n">I</span><span class="w">   </span><span class="n">INTEGER</span><span class="w"> </span><span class="n">index</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">partial</span><span class="w"> </span><span class="n">function</span><span class="o">.</span>
<span class="w">  </span><span class="n">FC</span><span class="w">        </span><span class="n">O</span><span class="w">   </span><span class="n">DOUBLE</span><span class="w"> </span><span class="n">PRECISION</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">KC</span><span class="o">-</span><span class="n">th</span><span class="w"> </span><span class="n">partial</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">at</span>
<span class="w">                </span><span class="n">the</span><span class="w"> </span><span class="n">point</span><span class="w"> </span><span class="n">X</span><span class="o">.</span>
<span class="w">  </span><span class="n">GC</span><span class="p">(</span><span class="n">NF</span><span class="p">)</span><span class="w">    </span><span class="n">O</span><span class="w">   </span><span class="n">DOUBLE</span><span class="w"> </span><span class="n">PRECISION</span><span class="w"> </span><span class="n">gradient</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">KC</span><span class="o">-</span><span class="n">th</span><span class="w"> </span><span class="n">partial</span><span class="w"> </span><span class="n">function</span>
<span class="w">                </span><span class="n">at</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">point</span><span class="w"> </span><span class="n">X</span><span class="o">.</span>
</code></pre></div>

<h2>Subroutine PSQP</h2>
<p>This general subroutine is called from all the subroutines described
in Section 2. The calling sequence is</p>
<div class="codehilite"><pre><span></span><code><span class="w">      </span><span class="k">CALL</span><span class="w"> </span><span class="n">PSQP</span><span class="p">(</span><span class="n">NF</span><span class="p">,</span><span class="n">NB</span><span class="p">,</span><span class="n">NC</span><span class="p">,</span><span class="n">X</span><span class="p">,</span><span class="n">IX</span><span class="p">,</span><span class="n">XL</span><span class="p">,</span><span class="n">XU</span><span class="p">,</span><span class="n">CF</span><span class="p">,</span><span class="n">IC</span><span class="p">,</span><span class="n">CL</span><span class="p">,</span><span class="n">CU</span><span class="p">,</span><span class="n">CG</span><span class="p">,</span><span class="n">CFO</span><span class="p">,</span><span class="n">CFD</span><span class="p">,</span><span class="n">GC</span><span class="p">,</span><span class="n">ICA</span><span class="p">,</span><span class="n">CR</span><span class="p">,</span>
<span class="w">     </span><span class="o">&amp;</span><span class="w"> </span><span class="n">CZ</span><span class="p">,</span><span class="n">CP</span><span class="p">,</span><span class="n">GF</span><span class="p">,</span><span class="n">G</span><span class="p">,</span><span class="n">H</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">XO</span><span class="p">,</span><span class="k">GO</span><span class="p">,</span><span class="n">XMAX</span><span class="p">,</span><span class="n">TOLX</span><span class="p">,</span><span class="n">TOLC</span><span class="p">,</span><span class="n">TOLG</span><span class="p">,</span><span class="n">RPF</span><span class="p">,</span><span class="n">CMAX</span><span class="p">,</span><span class="n">GMAX</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="n">MIT</span><span class="p">,</span>
<span class="w">     </span><span class="o">&amp;</span><span class="w"> </span><span class="n">MFV</span><span class="p">,</span><span class="n">MEC</span><span class="p">,</span><span class="n">IPRNT</span><span class="p">,</span><span class="n">ITERM</span><span class="p">).</span>
</code></pre></div>

<p>The arguments NF, NB, NC, X, IX, XL, XU, CF, IC, CL, CU, CMAX, GMAX,
F, IPRNT, ITERM, have the same meaning as in Section 2. Other arguments
have the following meaning:</p>
<div class="codehilite"><pre><span></span><code><span class="w"> </span><span class="nx">Argument</span><span class="w">  </span><span class="nx">Type</span><span class="w"> </span><span class="nx">Significance</span>
<span class="w"> </span><span class="o">----------------------------------------------------------------------</span>
<span class="w">  </span><span class="nx">CG</span><span class="p">(</span><span class="nx">NF</span><span class="o">*</span><span class="nx">NC</span><span class="p">)</span><span class="w"> </span><span class="nx">A</span><span class="w">   </span><span class="nx">DOUBLE</span><span class="w"> </span><span class="nx">PRECISION</span><span class="w"> </span><span class="nx">elements</span><span class="w"> </span><span class="nx">of</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="kd">constraint</span><span class="w"> </span><span class="nx">Jacobian</span>
<span class="w">                </span><span class="nx">matrix</span><span class="p">.</span>
<span class="w">  </span><span class="nx">CFO</span><span class="p">(</span><span class="nx">NC</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="nx">A</span><span class="w">   </span><span class="nx">DOUBLE</span><span class="w"> </span><span class="nx">PRECISION</span><span class="w"> </span><span class="nx">vector</span><span class="w"> </span><span class="nx">which</span><span class="w"> </span><span class="nx">contains</span><span class="w"> </span><span class="nx">old</span><span class="w"> </span><span class="nx">values</span><span class="w"> </span><span class="nx">of</span>
<span class="w">                 </span><span class="kd">constraint</span><span class="w"> </span><span class="nx">functions</span><span class="p">.</span>
<span class="w">  </span><span class="nx">CFD</span><span class="p">(</span><span class="nx">NC</span><span class="p">)</span><span class="w">   </span><span class="nx">A</span><span class="w">   </span><span class="nx">DOUBLE</span><span class="w"> </span><span class="nx">PRECISION</span><span class="w"> </span><span class="nx">vector</span><span class="w"> </span><span class="nx">of</span><span class="w"> </span><span class="kd">constraint</span><span class="w"> </span><span class="nx">function</span>
<span class="w">                </span><span class="nx">increments</span><span class="p">.</span>
<span class="w">  </span><span class="nx">GC</span><span class="p">(</span><span class="nx">NF</span><span class="p">)</span><span class="w">    </span><span class="nx">A</span><span class="w">   </span><span class="nx">DOUBLE</span><span class="w"> </span><span class="nx">PRECISION</span><span class="w"> </span><span class="nx">gradient</span><span class="w"> </span><span class="nx">of</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="kd">constraint</span><span class="w"> </span><span class="nx">function</span><span class="p">.</span>
<span class="w">  </span><span class="nx">ICA</span><span class="p">(</span><span class="nx">NC</span><span class="p">)</span><span class="w">   </span><span class="nx">A</span><span class="w">   </span><span class="nx">INTEGER</span><span class="w"> </span><span class="nx">vector</span><span class="w"> </span><span class="nx">containing</span><span class="w"> </span><span class="nx">indices</span><span class="w"> </span><span class="nx">of</span><span class="w"> </span><span class="nx">active</span><span class="w"> </span><span class="nx">constraints</span><span class="p">.</span>
<span class="w">  </span><span class="nx">CR</span><span class="p">(</span><span class="nx">NCR</span><span class="p">)</span><span class="w">   </span><span class="nx">A</span><span class="w">   </span><span class="nx">DOUBLE</span><span class="w"> </span><span class="nx">PRECISION</span><span class="w"> </span><span class="nx">matrix</span><span class="w"> </span><span class="nx">containing</span><span class="w"> </span><span class="nx">triangular</span>
<span class="w">                </span><span class="nx">decomposition</span><span class="w"> </span><span class="nx">of</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">orthogonal</span><span class="w"> </span><span class="nx">projection</span><span class="w"> </span><span class="nx">kernel</span>
<span class="w">                </span><span class="p">(</span><span class="nx">NCR</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="nx">equal</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">NF</span><span class="o">*</span><span class="p">(</span><span class="nx">NF</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">).</span>
<span class="w">  </span><span class="nx">CZ</span><span class="p">(</span><span class="nx">NF</span><span class="p">)</span><span class="w">    </span><span class="nx">A</span><span class="w">   </span><span class="nx">DOUBLE</span><span class="w"> </span><span class="nx">PRECISION</span><span class="w"> </span><span class="nx">vector</span><span class="w"> </span><span class="nx">of</span><span class="w"> </span><span class="nx">Lagrange</span><span class="w"> </span><span class="nx">multipliers</span><span class="p">.</span>
<span class="w">                </span><span class="nx">of</span><span class="w"> </span><span class="nx">linear</span><span class="w"> </span><span class="nx">manifold</span><span class="w"> </span><span class="nx">defined</span><span class="w"> </span><span class="nx">by</span><span class="w"> </span><span class="nx">active</span><span class="w"> </span><span class="nx">constraints</span><span class="p">.</span>
<span class="w">  </span><span class="nx">CP</span><span class="p">(</span><span class="nx">NF</span><span class="p">)</span><span class="w">    </span><span class="nx">A</span><span class="w">   </span><span class="nx">DOUBLE</span><span class="w"> </span><span class="nx">PRECISION</span><span class="w"> </span><span class="nx">auxiliary</span><span class="w"> </span><span class="nx">array</span><span class="p">.</span>
<span class="w">  </span><span class="nx">GF</span><span class="p">(</span><span class="nx">NF</span><span class="p">)</span><span class="w">    </span><span class="nx">A</span><span class="w">   </span><span class="nx">DOUBLE</span><span class="w"> </span><span class="nx">PRECISION</span><span class="w"> </span><span class="nx">gradient</span><span class="w"> </span><span class="nx">of</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">objective</span><span class="w"> </span><span class="nx">function</span><span class="p">.</span>
<span class="w">  </span><span class="nx">G</span><span class="p">(</span><span class="nx">NF</span><span class="p">)</span><span class="w">     </span><span class="nx">A</span><span class="w">   </span><span class="nx">DOUBLE</span><span class="w"> </span><span class="nx">PRECISION</span><span class="w"> </span><span class="nx">gradient</span><span class="w"> </span><span class="nx">of</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">Lagrangian</span><span class="w"> </span><span class="nx">function</span><span class="p">.</span>
<span class="w">  </span><span class="nx">H</span><span class="p">(</span><span class="nx">NH</span><span class="p">)</span><span class="w">     </span><span class="nx">A</span><span class="w">   </span><span class="nx">DOUBLE</span><span class="w"> </span><span class="nx">PRECISION</span><span class="w"> </span><span class="nx">variable</span><span class="w"> </span><span class="nx">metric</span><span class="w"> </span><span class="nx">approximation</span><span class="w"> </span><span class="nx">of</span><span class="w"> </span><span class="nx">the</span>
<span class="w">                </span><span class="nx">Hessian</span><span class="w"> </span><span class="nx">matrix</span><span class="w"> </span><span class="nx">of</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">Lagrangian</span><span class="w"> </span><span class="nx">function</span><span class="p">.</span>
<span class="w">  </span><span class="nx">S</span><span class="p">(</span><span class="nx">NF</span><span class="p">)</span><span class="w">     </span><span class="nx">A</span><span class="w">   </span><span class="nx">DOUBLE</span><span class="w"> </span><span class="nx">PRECISION</span><span class="w"> </span><span class="nx">direction</span><span class="w"> </span><span class="nx">vector</span><span class="p">.</span>
<span class="w">  </span><span class="nx">XO</span><span class="p">(</span><span class="nx">NF</span><span class="p">)</span><span class="w">    </span><span class="nx">A</span><span class="w">   </span><span class="nx">DOUBLE</span><span class="w"> </span><span class="nx">PRECISION</span><span class="w"> </span><span class="nx">vector</span><span class="w"> </span><span class="nx">which</span><span class="w"> </span><span class="nx">contains</span><span class="w"> </span><span class="nx">increments</span><span class="w"> </span><span class="nx">of</span>
<span class="w">                </span><span class="nx">variables</span><span class="p">.</span>
<span class="w">  </span><span class="nx">GO</span><span class="p">(</span><span class="nx">NF</span><span class="p">)</span><span class="w">    </span><span class="nx">A</span><span class="w">   </span><span class="nx">DOUBLE</span><span class="w"> </span><span class="nx">PRECISION</span><span class="w"> </span><span class="nx">vector</span><span class="w"> </span><span class="nx">which</span><span class="w"> </span><span class="nx">contains</span><span class="w"> </span><span class="nx">increments</span><span class="w"> </span><span class="nx">of</span>
<span class="w">                </span><span class="nx">gradients</span><span class="p">.</span>
<span class="w">  </span><span class="nx">XMAX</span><span class="w">      </span><span class="nx">I</span><span class="w">   </span><span class="nx">DOUBLE</span><span class="w"> </span><span class="nx">PRECISION</span><span class="w"> </span><span class="nx">maximum</span><span class="w"> </span><span class="nx">stepsize</span><span class="p">;</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="kd">choice</span><span class="w"> </span><span class="nx">XMAX</span><span class="p">=</span><span class="mi">0</span>
<span class="w">                </span><span class="nx">causes</span><span class="w"> </span><span class="nx">that</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="nx">value</span><span class="w"> </span><span class="m m-Double">1.0</span><span class="nx">D</span><span class="o">+</span><span class="mi">3</span><span class="w"> </span><span class="nx">will</span><span class="w"> </span><span class="nx">be</span><span class="w"> </span><span class="nx">taken</span><span class="p">.</span>
<span class="w">  </span><span class="nx">TOLX</span><span class="w">      </span><span class="nx">I</span><span class="w">   </span><span class="nx">DOUBLE</span><span class="w"> </span><span class="nx">PRECISION</span><span class="w"> </span><span class="nx">tolerance</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">change</span><span class="w"> </span><span class="nx">of</span><span class="w"> </span><span class="nx">the</span>
<span class="w">                </span><span class="nx">coordinate</span><span class="w"> </span><span class="nx">vector</span><span class="w"> </span><span class="nx">X</span><span class="p">;</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="kd">choice</span><span class="w"> </span><span class="nx">TOLX</span><span class="p">=</span><span class="mi">0</span><span class="w"> </span><span class="nx">causes</span><span class="w"> </span><span class="nx">that</span><span class="w"> </span><span class="nx">the</span>
<span class="w">                </span><span class="k">default</span><span class="w"> </span><span class="nx">value</span><span class="w"> </span><span class="nx">TOLX</span><span class="p">=</span><span class="m m-Double">1.0</span><span class="nx">D</span><span class="o">-</span><span class="mi">16</span><span class="w"> </span><span class="nx">will</span><span class="w"> </span><span class="nx">be</span><span class="w"> </span><span class="nx">taken</span><span class="p">.</span>
<span class="w">  </span><span class="nx">TOLC</span><span class="w">      </span><span class="nx">I</span><span class="w">   </span><span class="nx">DOUBLE</span><span class="w"> </span><span class="nx">PRECISION</span><span class="w"> </span><span class="nx">tolerance</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="kd">constraint</span><span class="w"> </span><span class="nx">violation</span><span class="p">;</span>
<span class="w">                </span><span class="nx">the</span><span class="w"> </span><span class="kd">choice</span><span class="w"> </span><span class="nx">TOLC</span><span class="p">=</span><span class="mi">0</span><span class="w"> </span><span class="nx">causes</span><span class="w"> </span><span class="nx">that</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="k">default</span>
<span class="w">                </span><span class="nx">value</span><span class="w"> </span><span class="nx">TOLC</span><span class="p">=</span><span class="m m-Double">1.0</span><span class="nx">D</span><span class="o">-</span><span class="mi">6</span><span class="w"> </span><span class="nx">will</span><span class="w"> </span><span class="nx">be</span><span class="w"> </span><span class="nx">taken</span><span class="p">.</span>
<span class="w">  </span><span class="nx">TOLG</span><span class="w">      </span><span class="nx">I</span><span class="w">   </span><span class="nx">DOUBLE</span><span class="w"> </span><span class="nx">PRECISION</span><span class="w"> </span><span class="nx">tolerance</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">Lagrangian</span><span class="w"> </span><span class="nx">function</span>
<span class="w">                </span><span class="nx">gradient</span><span class="p">;</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="kd">choice</span><span class="w"> </span><span class="nx">TOLG</span><span class="p">=</span><span class="mi">0</span><span class="w"> </span><span class="nx">causes</span><span class="w"> </span><span class="nx">that</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="k">default</span>
<span class="w">                </span><span class="nx">value</span><span class="w"> </span><span class="nx">TOLG</span><span class="p">=</span><span class="m m-Double">1.0</span><span class="nx">D</span><span class="o">-</span><span class="mi">6</span><span class="w"> </span><span class="nx">will</span><span class="w"> </span><span class="nx">be</span><span class="w"> </span><span class="nx">taken</span><span class="p">.</span>
<span class="w">  </span><span class="nx">RPF</span><span class="w">       </span><span class="nx">I</span><span class="w">   </span><span class="nx">DOUBLE</span><span class="w"> </span><span class="nx">PRECISION</span><span class="w"> </span><span class="nx">value</span><span class="w"> </span><span class="nx">of</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">penalty</span><span class="w"> </span><span class="nx">coefficient</span><span class="p">;</span><span class="w"> </span><span class="nx">the</span>
<span class="w">                </span><span class="kd">choice</span><span class="w"> </span><span class="nx">RPF</span><span class="p">=</span><span class="mi">0</span><span class="w"> </span><span class="nx">causes</span><span class="w"> </span><span class="nx">that</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="nx">value</span><span class="w"> </span><span class="m m-Double">1.0</span><span class="nx">D</span><span class="o">-</span><span class="mi">4</span><span class="w"> </span><span class="nx">will</span>
<span class="w">                </span><span class="nx">be</span><span class="w"> </span><span class="nx">taken</span><span class="p">.</span>
<span class="w">  </span><span class="nx">MIT</span><span class="w">       </span><span class="nx">I</span><span class="w">   </span><span class="nx">INTEGER</span><span class="w"> </span><span class="nx">variable</span><span class="w"> </span><span class="nx">that</span><span class="w"> </span><span class="nx">specifies</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">maximum</span><span class="w"> </span><span class="nx">number</span><span class="w"> </span><span class="nx">of</span>
<span class="w">                </span><span class="nx">iterations</span><span class="p">;</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="kd">choice</span><span class="w"> </span><span class="nx">MIT</span><span class="p">=</span><span class="mi">0</span><span class="w"> </span><span class="nx">causes</span><span class="w"> </span><span class="nx">that</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="k">default</span>
<span class="w">                </span><span class="nx">value</span><span class="w"> </span><span class="mi">1000</span><span class="w"> </span><span class="nx">will</span><span class="w"> </span><span class="nx">be</span><span class="w"> </span><span class="nx">taken</span><span class="p">.</span>
<span class="w">  </span><span class="nx">MFV</span><span class="w">       </span><span class="nx">I</span><span class="w">   </span><span class="nx">INTEGER</span><span class="w"> </span><span class="nx">variable</span><span class="w"> </span><span class="nx">that</span><span class="w"> </span><span class="nx">specifies</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">maximum</span><span class="w"> </span><span class="nx">number</span><span class="w"> </span><span class="nx">of</span>
<span class="w">                </span><span class="nx">function</span><span class="w"> </span><span class="nx">evaluations</span><span class="p">;</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="kd">choice</span><span class="w"> </span><span class="o">|</span><span class="nx">MFV</span><span class="o">|=</span><span class="mi">0</span><span class="w"> </span><span class="nx">causes</span><span class="w"> </span><span class="nx">that</span>
<span class="w">                </span><span class="nx">the</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="nx">value</span><span class="w"> </span><span class="mi">2000</span><span class="w"> </span><span class="nx">will</span><span class="w"> </span><span class="nx">be</span><span class="w"> </span><span class="nx">taken</span><span class="p">.</span>
<span class="w">  </span><span class="nx">MET</span><span class="w">       </span><span class="nx">I</span><span class="w">   </span><span class="nx">INTEGER</span><span class="w"> </span><span class="nx">variable</span><span class="w"> </span><span class="nx">that</span><span class="w"> </span><span class="nx">specifies</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">variable</span><span class="w"> </span><span class="nx">metric</span>
<span class="w">                </span><span class="nx">update</span><span class="p">.</span>
<span class="w">                  </span><span class="nx">MET</span><span class="p">=</span><span class="mi">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">BFGS</span><span class="w"> </span><span class="nx">update</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="nx">used</span><span class="p">.</span>
<span class="w">                  </span><span class="nx">MET</span><span class="p">=</span><span class="mi">2</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">Hoshino</span><span class="w"> </span><span class="nx">update</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="nx">used</span><span class="p">.</span>
<span class="w">                </span><span class="nx">The</span><span class="w"> </span><span class="kd">choice</span><span class="w"> </span><span class="nx">MET</span><span class="p">=</span><span class="mi">0</span><span class="w"> </span><span class="nx">causes</span><span class="w"> </span><span class="nx">that</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="nx">value</span><span class="w"> </span><span class="nx">MET</span><span class="p">=</span><span class="mi">1</span>
<span class="w">                </span><span class="nx">will</span><span class="w"> </span><span class="nx">be</span><span class="w"> </span><span class="nx">taken</span><span class="p">.</span>
<span class="w">  </span><span class="nx">MEC</span><span class="w">       </span><span class="nx">I</span><span class="w">   </span><span class="nx">INTEGER</span><span class="w"> </span><span class="nx">variable</span><span class="w"> </span><span class="nx">that</span><span class="w"> </span><span class="nx">specifies</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="nx">correction</span><span class="w"> </span><span class="nx">when</span><span class="w"> </span><span class="nx">the</span>
<span class="w">                </span><span class="nx">negative</span><span class="w"> </span><span class="nx">curvature</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="nx">detected</span><span class="p">:</span>
<span class="w">                  </span><span class="nx">MEC</span><span class="p">=</span><span class="mi">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">correction</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="nx">used</span><span class="p">.</span>
<span class="w">                  </span><span class="nx">MEC</span><span class="p">=</span><span class="mi">2</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">Powell</span><span class="w"> </span><span class="nx">correction</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="nx">used</span><span class="p">.</span>
<span class="w">                </span><span class="nx">The</span><span class="w"> </span><span class="kd">choice</span><span class="w"> </span><span class="nx">MEC</span><span class="p">=</span><span class="mi">0</span><span class="w"> </span><span class="nx">causes</span><span class="w"> </span><span class="nx">that</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="nx">value</span><span class="w"> </span><span class="nx">MEC</span><span class="p">=</span><span class="mi">2</span>
<span class="w">                </span><span class="nx">will</span><span class="w"> </span><span class="nx">be</span><span class="w"> </span><span class="nx">taken</span><span class="p">.</span>
</code></pre></div>

<p>The default velue RPF=0.0001 is relatively small. Therefore, larger
value (RPF=1 say) can sometimes be more suitable.</p>
<p>The subroutine PSQP requires the user supplied subroutines OBJ
DOBJ, CON, DCON,  which are described in Section 2.</p>
<h2>Subroutine PLQDB1</h2>
<p>Since the dual range space method for solving quadratic programming
subproblems arising in sequential quadratic programming algorithms
can be used separately in many applications, we describe the subroutine
PLQDB1 in more details. The calling sequence is</p>
<div class="codehilite"><pre><span></span><code><span class="w">      </span><span class="k">CALL</span><span class="w"> </span><span class="n">PLQDB1</span><span class="p">(</span><span class="n">NF</span><span class="p">,</span><span class="n">NC</span><span class="p">,</span><span class="n">X</span><span class="p">,</span><span class="n">IX</span><span class="p">,</span><span class="n">XL</span><span class="p">,</span><span class="n">XU</span><span class="p">,</span><span class="n">CF</span><span class="p">,</span><span class="n">CFD</span><span class="p">,</span><span class="n">IC</span><span class="p">,</span><span class="n">ICA</span><span class="p">,</span><span class="n">CL</span><span class="p">,</span><span class="n">CU</span><span class="p">,</span><span class="n">CG</span><span class="p">,</span><span class="n">CR</span><span class="p">,</span><span class="n">CZ</span><span class="p">,</span><span class="n">G</span><span class="p">,</span><span class="k">GO</span><span class="p">,</span>
<span class="w">     </span><span class="o">&amp;</span><span class="w"> </span><span class="n">H</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">MFP</span><span class="p">,</span><span class="n">KBF</span><span class="p">,</span><span class="n">KBC</span><span class="p">,</span><span class="n">IDECF</span><span class="p">,</span><span class="n">ETA2</span><span class="p">,</span><span class="n">ETA9</span><span class="p">,</span><span class="n">EPS7</span><span class="p">,</span><span class="n">EPS9</span><span class="p">,</span><span class="n">UMAX</span><span class="p">,</span><span class="n">GMAX</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">ITERQ</span><span class="p">)</span>
</code></pre></div>

<p>The arguments NF, NC, X, IX, XL, XU, CF, IC, CL, CU, have the same
meaning as in Section 2 (only with the difference that the
arguments X and CF are of the type (I), i.e. they  must have a value
defined on entry to ULQDF1 and they are not changed). The arguments
CFD, ICA, CG, CR, CZ have the same meaning as in Section 3 (only with
the difference that the arguments CFD, ICA, CR, CZ are of the type (O),
i.e. their values can be used subsequently). Other arguments have the
following meaning:</p>
<div class="codehilite"><pre><span></span><code><span class="w"> </span><span class="nx">Argument</span><span class="w">  </span><span class="nx">Type</span><span class="w"> </span><span class="nx">Significance</span>
<span class="w"> </span><span class="o">----------------------------------------------------------------------</span>
<span class="w">  </span><span class="nx">G</span><span class="p">(</span><span class="nx">NF</span><span class="p">)</span><span class="w">     </span><span class="nx">O</span><span class="w">   </span><span class="nx">DOUBLE</span><span class="w"> </span><span class="nx">PRECISION</span><span class="w"> </span><span class="nx">gradient</span><span class="w"> </span><span class="nx">of</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">Lagrangian</span><span class="w"> </span><span class="nx">function</span><span class="p">.</span>
<span class="w">  </span><span class="nx">GO</span><span class="p">(</span><span class="nx">NF</span><span class="p">)</span><span class="w">    </span><span class="nx">A</span><span class="w">   </span><span class="nx">DOUBLE</span><span class="w"> </span><span class="nx">PRECISION</span><span class="w"> </span><span class="nx">old</span><span class="w"> </span><span class="nx">gradient</span><span class="w"> </span><span class="nx">of</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">Lagrangian</span>
<span class="w">                </span><span class="nx">function</span><span class="p">.</span>
<span class="w">  </span><span class="nx">H</span><span class="p">(</span><span class="nx">NH</span><span class="p">)</span><span class="w">     </span><span class="nx">U</span><span class="w">   </span><span class="nx">DOUBLE</span><span class="w"> </span><span class="nx">PRECISION</span><span class="w"> </span><span class="nx">Choleski</span><span class="w"> </span><span class="nx">decomposition</span><span class="w"> </span><span class="nx">of</span><span class="w"> </span><span class="nx">the</span>
<span class="w">                </span><span class="nx">approximate</span><span class="w"> </span><span class="nx">Hessian</span><span class="w"> </span><span class="p">(</span><span class="nx">NH</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="nx">equal</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">NF</span><span class="o">*</span><span class="p">(</span><span class="nx">NF</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">).</span>
<span class="w">  </span><span class="nx">S</span><span class="p">(</span><span class="nx">NF</span><span class="p">)</span><span class="w">     </span><span class="nx">O</span><span class="w">   </span><span class="nx">DOUBLE</span><span class="w"> </span><span class="nx">PRECISION</span><span class="w"> </span><span class="nx">direction</span><span class="w"> </span><span class="nx">vector</span><span class="p">.</span>
<span class="w">  </span><span class="nx">MFP</span><span class="w">       </span><span class="nx">I</span><span class="w">   </span><span class="nx">INTEGER</span><span class="w"> </span><span class="nx">variable</span><span class="w"> </span><span class="nx">that</span><span class="w"> </span><span class="nx">specifies</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="k">type</span><span class="w"> </span><span class="nx">of</span><span class="w"> </span><span class="nx">the</span>
<span class="w">                </span><span class="nx">computed</span><span class="w"> </span><span class="nx">point</span><span class="p">.</span>
<span class="w">                  </span><span class="nx">MFP</span><span class="p">=</span><span class="mi">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">computation</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="nx">terminated</span><span class="w"> </span><span class="nx">whenever</span><span class="w"> </span><span class="nx">an</span>
<span class="w">                          </span><span class="nx">arbitrary</span><span class="w"> </span><span class="nx">feasible</span><span class="w"> </span><span class="nx">point</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="nx">found</span><span class="p">,</span>
<span class="w">                  </span><span class="nx">MFP</span><span class="p">=</span><span class="mi">2</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">computation</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="nx">terminated</span><span class="w"> </span><span class="nx">whenever</span><span class="w"> </span><span class="nx">an</span>
<span class="w">                          </span><span class="nx">optimum</span><span class="w"> </span><span class="nx">feasible</span><span class="w"> </span><span class="nx">point</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="nx">found</span><span class="p">,</span>
<span class="w">                  </span><span class="nx">MFP</span><span class="p">=</span><span class="mi">3</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">computation</span><span class="w"> </span><span class="nx">starts</span><span class="w"> </span><span class="nx">from</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">previously</span>
<span class="w">                          </span><span class="nx">reached</span><span class="w"> </span><span class="nx">point</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="nx">terminated</span><span class="w"> </span><span class="nx">whenever</span>
<span class="w">                          </span><span class="nx">an</span><span class="w"> </span><span class="nx">optimum</span><span class="w"> </span><span class="nx">feasible</span><span class="w"> </span><span class="nx">point</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="nx">found</span><span class="p">.</span>
<span class="w">  </span><span class="nx">KBF</span><span class="w">       </span><span class="nx">I</span><span class="w">   </span><span class="nx">INTEGER</span><span class="w"> </span><span class="nx">variable</span><span class="w"> </span><span class="nx">that</span><span class="w"> </span><span class="nx">specifies</span><span class="w"> </span><span class="nx">simple</span><span class="w"> </span><span class="nx">bounds</span><span class="w"> </span><span class="nx">on</span>
<span class="w">                </span><span class="nx">variables</span><span class="p">.</span>
<span class="w">                  </span><span class="nx">KBF</span><span class="p">=</span><span class="mi">0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">simple</span><span class="w"> </span><span class="nx">bounds</span><span class="w"> </span><span class="nx">are</span><span class="w"> </span><span class="nx">suppressed</span><span class="p">,</span>
<span class="w">                  </span><span class="nx">KBF</span><span class="p">=</span><span class="mi">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">one</span><span class="w"> </span><span class="nx">sided</span><span class="w"> </span><span class="nx">simple</span><span class="w"> </span><span class="nx">bounds</span><span class="p">,</span>
<span class="w">                  </span><span class="nx">KBF</span><span class="p">=</span><span class="mi">2</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">two</span><span class="w"> </span><span class="nx">sided</span><span class="w"> </span><span class="nx">simple</span><span class="w"> </span><span class="nx">bounds</span><span class="p">.</span>
<span class="w">  </span><span class="nx">KBC</span><span class="w">       </span><span class="nx">I</span><span class="w">   </span><span class="nx">INTEGER</span><span class="w"> </span><span class="nx">variable</span><span class="w"> </span><span class="nx">that</span><span class="w"> </span><span class="nx">specifies</span><span class="w"> </span><span class="nx">general</span><span class="w"> </span><span class="nx">linear</span>
<span class="w">                </span><span class="nx">constraints</span><span class="p">.</span>
<span class="w">                  </span><span class="nx">KBC</span><span class="p">=</span><span class="mi">0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">linear</span><span class="w"> </span><span class="nx">constraints</span><span class="w"> </span><span class="nx">are</span><span class="w"> </span><span class="nx">suppressed</span><span class="p">,</span>
<span class="w">                  </span><span class="nx">KBC</span><span class="p">=</span><span class="mi">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">one</span><span class="w"> </span><span class="nx">sided</span><span class="w"> </span><span class="nx">linear</span><span class="w"> </span><span class="nx">constraints</span><span class="p">,</span>
<span class="w">                  </span><span class="nx">KBC</span><span class="p">=</span><span class="mi">2</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">two</span><span class="w"> </span><span class="nx">sided</span><span class="w"> </span><span class="nx">linear</span><span class="w"> </span><span class="nx">constraints</span><span class="p">.</span>
<span class="w">  </span><span class="nx">IDECF</span><span class="w">     </span><span class="nx">U</span><span class="w">   </span><span class="nx">INTEGER</span><span class="w"> </span><span class="nx">variable</span><span class="w"> </span><span class="nx">that</span><span class="w"> </span><span class="nx">specifies</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="k">type</span><span class="w"> </span><span class="nx">of</span><span class="w"> </span><span class="nx">matrix</span>
<span class="w">                </span><span class="nx">decomposition</span><span class="p">.</span>
<span class="w">                  </span><span class="nx">IDECF</span><span class="p">=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">no</span><span class="w"> </span><span class="nx">decomposition</span><span class="p">,</span>
<span class="w">                  </span><span class="nx">IDECF</span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">Choleski</span><span class="w"> </span><span class="nx">decomposition</span><span class="p">,</span>
<span class="w">                  </span><span class="nx">IDECF</span><span class="p">=</span><span class="w"> </span><span class="mi">9</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">inversion</span><span class="p">,</span>
<span class="w">                  </span><span class="nx">IDECF</span><span class="p">=</span><span class="mi">10</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">diagonal</span><span class="w"> </span><span class="nx">matrix</span><span class="p">.</span>
<span class="w">  </span><span class="nx">ETA2</span><span class="w">      </span><span class="nx">I</span><span class="w">   </span><span class="nx">DOUBLE</span><span class="w"> </span><span class="nx">PRECISION</span><span class="w"> </span><span class="nx">tolerance</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nx">positive</span><span class="w"> </span><span class="nx">definiteness</span>
<span class="w">                </span><span class="k">in</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">Choleski</span><span class="w"> </span><span class="nx">decomposition</span><span class="p">.</span>
<span class="w">  </span><span class="nx">ETA9</span><span class="w">      </span><span class="nx">I</span><span class="w">   </span><span class="nx">DOUBLE</span><span class="w"> </span><span class="nx">PRECISION</span><span class="w"> </span><span class="nx">maximum</span><span class="w"> </span><span class="nx">floating</span><span class="w"> </span><span class="nx">point</span><span class="w"> </span><span class="nx">number</span><span class="p">.</span>
<span class="w">  </span><span class="nx">EPS7</span><span class="w">      </span><span class="nx">I</span><span class="w">   </span><span class="nx">DOUBLE</span><span class="w"> </span><span class="nx">PRECISION</span><span class="w"> </span><span class="nx">tolerance</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nx">linear</span><span class="w"> </span><span class="nx">independence</span>
<span class="w">                </span><span class="nx">of</span><span class="w"> </span><span class="nx">constraints</span><span class="w"> </span><span class="p">(</span><span class="nx">the</span><span class="w"> </span><span class="nx">recommended</span><span class="w"> </span><span class="nx">value</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="m m-Double">1.0</span><span class="nx">D</span><span class="o">-</span><span class="mi">10</span><span class="p">).</span>
<span class="w">  </span><span class="nx">EPS9</span><span class="w">      </span><span class="nx">I</span><span class="w">   </span><span class="nx">DOUBLE</span><span class="w"> </span><span class="nx">PRECISION</span><span class="w"> </span><span class="nx">tolerance</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">definition</span><span class="w"> </span><span class="nx">of</span><span class="w"> </span><span class="nx">active</span>
<span class="w">                </span><span class="nx">constraints</span><span class="w"> </span><span class="p">(</span><span class="nx">the</span><span class="w"> </span><span class="nx">recommended</span><span class="w"> </span><span class="nx">value</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="m m-Double">1.0</span><span class="nx">D</span><span class="o">-</span><span class="mi">8</span><span class="p">).</span>
<span class="w">  </span><span class="nx">UMAX</span><span class="w">      </span><span class="nx">O</span><span class="w">   </span><span class="nx">DOUBLE</span><span class="w"> </span><span class="nx">PRECISION</span><span class="w"> </span><span class="nx">maximum</span><span class="w"> </span><span class="nx">absolute</span><span class="w"> </span><span class="nx">value</span><span class="w"> </span><span class="nx">of</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">negative</span>
<span class="w">                </span><span class="nx">Lagrange</span><span class="w"> </span><span class="nx">multiplier</span><span class="p">.</span>
<span class="w">  </span><span class="nx">GMAX</span><span class="w">      </span><span class="nx">O</span><span class="w">   </span><span class="nx">DOUBLE</span><span class="w"> </span><span class="nx">PRECISION</span><span class="w"> </span><span class="nx">infinity</span><span class="w"> </span><span class="nx">norm</span><span class="w"> </span><span class="nx">of</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">gradient</span><span class="w"> </span><span class="nx">of</span><span class="w"> </span><span class="nx">the</span>
<span class="w">                </span><span class="nx">Lagrangian</span><span class="w"> </span><span class="nx">function</span><span class="p">.</span>
<span class="w">  </span><span class="nx">N</span><span class="w">         </span><span class="nx">O</span><span class="w">   </span><span class="nx">INTEGER</span><span class="w"> </span><span class="nx">dimension</span><span class="w"> </span><span class="nx">of</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="nx">manifold</span><span class="w"> </span><span class="nx">defined</span><span class="w"> </span><span class="nx">by</span><span class="w"> </span><span class="nx">active</span>
<span class="w">                </span><span class="nx">constraints</span><span class="p">.</span>
<span class="w">  </span><span class="nx">ITERQ</span><span class="w">     </span><span class="nx">O</span><span class="w">   </span><span class="nx">INTEGER</span><span class="w"> </span><span class="nx">variable</span><span class="w"> </span><span class="nx">that</span><span class="w"> </span><span class="nx">indicates</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="k">type</span><span class="w"> </span><span class="nx">of</span><span class="w"> </span><span class="nx">the</span>
<span class="w">                </span><span class="nx">computed</span><span class="w"> </span><span class="nx">feasible</span><span class="w"> </span><span class="nx">point</span><span class="p">.</span>
<span class="w">                  </span><span class="nx">ITERQ</span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">an</span><span class="w"> </span><span class="nx">arbitrary</span><span class="w"> </span><span class="nx">feasible</span><span class="w"> </span><span class="nx">point</span><span class="w"> </span><span class="nx">was</span><span class="w"> </span><span class="nx">found</span><span class="p">,</span>
<span class="w">                  </span><span class="nx">ITERQ</span><span class="p">=</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">optimum</span><span class="w"> </span><span class="nx">feasible</span><span class="w"> </span><span class="nx">point</span><span class="w"> </span><span class="nx">was</span><span class="w"> </span><span class="nx">found</span><span class="p">,</span>
<span class="w">                  </span><span class="nx">ITERQ</span><span class="p">=</span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">an</span><span class="w"> </span><span class="nx">arbitrary</span><span class="w"> </span><span class="nx">feasible</span><span class="w"> </span><span class="nx">point</span><span class="w"> </span><span class="nx">does</span><span class="w"> </span><span class="k">not</span>
<span class="w">                             </span><span class="nx">exist</span><span class="p">,</span>
<span class="w">                  </span><span class="nx">ITERQ</span><span class="p">=</span><span class="o">-</span><span class="mi">2</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">optimum</span><span class="w"> </span><span class="nx">feasible</span><span class="w"> </span><span class="nx">point</span><span class="w"> </span><span class="nx">does</span><span class="w"> </span><span class="k">not</span>
<span class="w">                             </span><span class="nx">exist</span><span class="p">.</span>
</code></pre></div>

<h2>Verification of the subroutines</h2>
<p>Subroutine PSQPN can be verified and tested using the program
TSQPN. This program calls the subroutines TIND07 (initiation),
TFFU07 (objective function evaluation), TFGU07 (objective gradient
evaluation), TCFU07 (constraint functions evaluation) and TFGU07
(constraint gradients evaluation) containing 34 equality constrained
test problems with at most 20 variables. The results obtained
by the program TSQPN on a PC computer with Microsoft Power Station
Fortran compiler have the following form.</p>
<div class="codehilite"><pre><span></span><code>NIT=   7  NFV=   7  NFG=   7  F=-1.41421      C=0.8E-08  G=0.4E-06  ITERM=  4
NIT=  12  NFV=  12  NFG=  12  F=-1.00000      C=0.5E-10  G=0.6E-07  ITERM=  4
NIT=  10  NFV=  11  NFG=  10  F=-30.0000      C=0.3E-10  G=0.8E-08  ITERM=  4
NIT=   6  NFV=   6  NFG=   6  F= 1.28072      C=0.0E+00  G=0.4E-06  ITERM=  4
NIT=  36  NFV=  40  NFG=  36  F=0.284597E-01  C=0.0E+00  G=0.1E-06  ITERM=  4
NIT=  11  NFV=  13  NFG=  11  F= 1.00000      C=0.0E+00  G=0.4E-06  ITERM=  4
NIT=   6  NFV=   6  NFG=   6  F=-6961.81      C=0.7E-08  G=0.1E-06  ITERM=  4
NIT=   4  NFV=   4  NFG=   4  F= 40.1987      C=0.0E+00  G=0.2E-06  ITERM=  4
NIT=   9  NFV=   9  NFG=   9  F= 13.3567      C=0.3E-06  G=0.8E-07  ITERM=  4
NIT=  16  NFV=  23  NFG=  16  F=-22.6274      C=0.9E-11  G=0.3E-06  ITERM=  4
NIT=  14  NFV=  14  NFG=  14  F= 1.00000      C=0.0E+00  G=0.8E-06  ITERM=  4
NIT=  10  NFV=  13  NFG=  10  F= 6.00000      C=0.2E-12  G=0.1E-06  ITERM=  4
NIT=  54  NFV=  71  NFG=  54  F= 6299.84      C=0.4E-15  G=0.2E-07  ITERM=  4
NIT=   8  NFV=   8  NFG=   8  F=-.834032      C=0.3E-07  G=0.3E-08  ITERM=  4
NIT=  30  NFV=  30  NFG=  30  F=-1162.12      C=0.0E+00  G=0.1E-06  ITERM=  4
NIT=  74  NFV=  76  NFG=  74  F= 4.75530      C=0.0E+00  G=0.4E-06  ITERM=  4
NIT=  22  NFV=  22  NFG=  22  F= 727.679      C=0.4E-14  G=0.7E-06  ITERM=  4
NIT=  11  NFV=  14  NFG=  11  F=-44.0000      C=0.9E-12  G=0.8E-07  ITERM=  4
NIT=  29  NFV=  35  NFG=  29  F=-210.408      C=0.2E-13  G=0.1E-06  ITERM=  4
NIT=   4  NFV=   4  NFG=   4  F=-30665.0      C=0.3E-08  G=0.1E-06  ITERM=  4
NIT=  11  NFV=  30  NFG=  11  F=-.528034E+07  C=0.0E+00  G=0.1E-07  ITERM=  4
NIT=  21  NFV=  21  NFG=  21  F=-1.90516      C=0.1E-08  G=0.2E-10  ITERM=  4
NIT=  10  NFV=  12  NFG=  10  F= 5.00000      C=0.2E-11  G=0.8E-07  ITERM=  4
NIT=  45  NFV=  50  NFG=  45  F= 135.076      C=0.3E-14  G=0.3E-07  ITERM=  4
NIT=  10  NFV=  10  NFG=  10  F= 4.07125      C=0.0E+00  G=0.7E-10  ITERM=  4
NIT=  16  NFV=  19  NFG=  16  F= 680.630      C=0.1E-11  G=0.5E-06  ITERM=  4
NIT=  26  NFV=  35  NFG=  26  F= 221.878      C=0.2E-15  G=0.3E-06  ITERM=  4
NIT=  32  NFV=  33  NFG=  32  F= 3.95116      C=0.9E-11  G=0.6E-06  ITERM=  4
NIT=  21  NFV=  21  NFG=  21  F= 7049.25      C=0.4E-07  G=0.1E-06  ITERM=  4
NIT=  16  NFV=  16  NFG=  16  F=-.866025      C=0.2E-08  G=0.2E-09  ITERM=  4
NIT=  22  NFV=  24  NFG=  22  F= 24.3062      C=0.5E-12  G=0.3E-06  ITERM=  4
NIT=  22  NFV=  22  NFG=  22  F= 32.3487      C=0.8E-12  G=0.1E-06  ITERM=  4
NIT=  77  NFV=  77  NFG=  77  F= 174.787      C=0.6E-11  G=0.4E-10  ITERM=  4
NIT=  32  NFV=  35  NFG=  32  F= 133.728      C=0.9E-13  G=0.8E-06  ITERM=  4
NITER =  734    NFVAL =  823    NSUCC =   34
TIME= 0:00:00.03
</code></pre></div>

<p>The rows corresponding to individual test problems contain the number of
iterations NIT, the number of function evaluations NFV, the number of
gradient evaluations NFG, the final value of the objective function F,
the constraint violation C, the norm of the Lagrangian function gradient
G and the cause of termination ITERM.</p>
        </div>
          <div class="col-md-4">
            <div class="card card-body bg-light">
              <h2 class="card-title">Developer Info</h2>
              <h4 class="card-text">Jacob Williams</h4>
              <p class="card-text"></p>
                <div class="text-center"><div class="btn-group" role="group">
                    
                    <a class="btn btn-lg btn-primary" href="https://github.com/jacobwilliams"><i class="fa fa-github fa-lg"></i></a>
                    
                    
                    
                    
                    
                    
                </div></div>
            </div>
          </div>
      </div>
        <div class="row">
          <hr>
          <div class="col-xs-6 col-sm-3">
            <div>
              <h3>Source Files</h3>
              <ul><li><a href='sourcefile/psqp_kind_module.f90.html'>psqp_kind_module.F90</a></li><li><a href='sourcefile/psqp_matrix_module.f90.html'>psqp_matrix_module.f90</a></li><li><a href='sourcefile/psqp_module.f90.html'>psqp_module.f90</a></li></ul>
            </div>
            <div>
              <ul>
                <li><a href="./lists/files.html"><em>All source files&hellip;</em></a></li>
              </ul>
            </div>
          </div>
          <div class="col-xs-6 col-sm-3">
            <div>
              <h3>Modules</h3>
              <ul><li><a href='module/psqp_kind_module.html'>psqp_kind_module</a></li><li><a href='module/psqp_matrix_module.html'>psqp_matrix_module</a></li><li><a href='module/psqp_module.html'>psqp_module</a></li></ul>
            </div>
            <div>
              <ul>
                <li><a href="./lists/modules.html"><em>All modules&hellip;</em></a></li>
              </ul>
            </div>
          </div>
          <div class="col-xs-6 col-sm-3">
            <div>
              <h3>Procedures</h3>
              <ul><li><a href='proc/bfgs_variable_metric_update.html'>bfgs_variable_metric_update</a></li><li><a href='proc/compute_augmented_lagrangian.html'>compute_augmented_lagrangian</a></li><li><a href='proc/compute_con_and_dcon.html'>compute_con_and_dcon</a></li><li><a href='proc/compute_new_penalty_parameters.html'>compute_new_penalty_parameters</a></li><li><a href='proc/compute_obj_and_dobj.html'>compute_obj_and_dobj</a></li><li><a href='proc/determine_new_active_linear_constr.html'>determine_new_active_linear_constr</a></li><li><a href='proc/determine_new_active_simple_bound.html'>determine_new_active_simple_bound</a></li><li><a href='proc/dual_range_space_qp.html'>dual_range_space_qp</a></li><li><a href='proc/dual_range_space_quad_prog.html'>dual_range_space_quad_prog</a></li><li><a href='proc/extended_line_search.html'>extended_line_search</a></li></ul>
            </div>
            <div>
              <ul>
                <li><a href="./lists/procedures.html"><em>All procedures&hellip;</em></a></li>
              </ul>
            </div>
          </div>
          <div class="col-xs-6 col-sm-3">
            <div>
              <h3>Derived Types</h3>
              <ul><li><a href='type/psqp_class.html'>psqp_class</a></li></ul>
            </div>
            <div>
              <ul>
                <li><a href="./lists/types.html"><em>All derived types&hellip;</em></a></li>
              </ul>
            </div>
          </div>
        </div>
      <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
        <div class="row justify-content-between">
          <div class="col">
            <p>
              psqp
 was developed by Jacob Williams<br>              &copy; 2025 
</p>
          </div>
          <div class="col">
            <p class="text-end">
              Documentation generated by
              <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
            </p>
          </div>
        </div>
        <br>
      </div> <!-- /container -->
    </footer>
  </body>
</html>